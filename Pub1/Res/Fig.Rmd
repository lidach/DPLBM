---
title: "Figures"
output: word_document 
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```


```{r}
# Packages and Objects to save --------------------------------------------
setwd("D:/DPLBM/Pub1/Res")
if(!require(TropFishR)) install.packages("gridExtra"); require(TropFishR)
if(!require(ggplot2)) install.packages("ggplot"); require(ggplot2)
if(!require(cowplot)) install.packages("gridExtra"); require(cowplot)
```

## LH plots

```{r}
## True LFQ ####
LFQshort <- readRDS("D:/DPLBM/Pub1/Shortlived/True/LFQshortmodel.rds")
LFQmed <- readRDS("D:/DPLBM/Pub1/Medlived/True/LFQmedmodel.rds")
LFQlong <- readRDS("D:/DPLBM/Pub1/Longlived/True/LFQlongmodel.rds")
set.seed(56)
i <- sample(1:300, 1)
LFQshort <- LFQshort[[i]]
LFQshort1 <- LFQshort
LFQmed <- LFQmed[[i]]
LFQmed1 <- LFQmed
LFQlong <- LFQlong[[i]]
LFQlong1 <- LFQlong


LFQshort1 <- lfqModify(LFQshort1, vectorise_catch = TRUE)
catchk <- LFQshort1$catch/sum(LFQshort1$catch)
LFQshort2 <- data.frame(midLengths = LFQshort1$midLengths, catch = catchk, life_history = rep("Short", length(catchk)))
LFQmed1 <- lfqModify(LFQmed1, vectorise_catch = TRUE)
catchk <- LFQmed1$catch/sum(LFQmed1$catch)
LFQmed2 <- data.frame(midLengths = LFQmed1$midLengths, catch = catchk, life_history = rep("Medium", length(catchk)))
LFQlong1 <- lfqModify(LFQlong1, vectorise_catch = TRUE)
catchk <- LFQlong1$catch/sum(LFQlong1$catch)
LFQlong2 <- data.frame(midLengths = LFQlong1$midLengths, catch = catchk, life_history = rep("Longer", length(catchk)))
LFQtot <- rbind.data.frame(LFQshort2, LFQmed2, LFQlong2)
vlinelen <- data.frame(life_history = levels(LFQtot$life_history), Linf = c(36.2, 64.6, 90), L50_m = c(20.2, 34, 50), L50_s = c(9, 11, 20)) 



Palette <- c("#bdbdbd", "#737373", "#252525")
Plot_LFQtot <- ggplot(LFQtot, aes(x = midLengths, y = catch, fill = life_history)) +
  geom_bar(stat = "identity") +
  labs(x = "Lengths (cm)", y = "Frequency") +
  scale_fill_manual(values = Palette) +
  coord_cartesian(ylim = c(0, 0.06)) +
  geom_vline(aes(xintercept = Linf, color = "Linf"), data = vlinelen) +
  geom_vline(aes(xintercept = L50_m, color = "L50_m"), data = vlinelen) +
  geom_vline(aes(xintercept = L50_s, color = "L50_s"), data = vlinelen) +
  facet_wrap(~life_history, nrow = 3) +
  guides(fill = guide_legend(title="Life history")) +
  scale_color_manual(name = "Lengths", 
                     values = c(Linf = "black", L50_m = "blue", L50_s = "red"), 
                     labels = expression(L[50]^m, L[50]^s, L[infinity])) 
Plot_LFQtot
ggsave("Plot_LFQtot.png", plot = Plot_LFQtot,
  scale = 1, width = 8, height = 6, units = "in")
```




## SPR
```{r, fig.width=16, fig.height=12}
LH_SPR <- readRDS("files/LH_SPR.rds")

Plot.LH_SPR <- ggplot(LH_SPR, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm")) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))

# ggsave("Plot_SPRTRUE_LH.png", plot = Plot_SPRTrue_LH,
#        scale = 1, width = 14, height = 7, units = "in")



Exp_SPR <- readRDS("files/Exp_SPR.rds")

Plot.Exp_SPR <- ggplot(Exp_SPR, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))
 
# ggsave("Plot_SPRTRUE_Exp.png", plot = Plot_SPRTrue_Exp,
#        scale = 1, width = 14, height = 7, units = "in")



Rec_SPR <- readRDS("files/Rec_SPR.rds")

Plot.Rec_SPR <- ggplot(Rec_SPR, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))





Plot_SPR <- plot_grid(Plot.LH_SPR + theme(legend.position = "none"), NULL, Plot.Exp_SPR + theme(legend.position = "none"), NULL, Plot.Rec_SPR + theme(legend.position = "none"),
          nrow = 5,
          rel_heights = c(1,-0.05,1,-0.05,1),
          align = "v")
legend <- get_legend(Plot.Exp_SPR)

Plot_SPR1 <- plot_grid(Plot_SPR, legend, labels = c("",""),
                       rel_widths = c(3,0.3)) +
  draw_label("Relative error", x = 0, y = 0.35, hjust = -0.6, vjust = 1, angle = 90, size = 20) 
title <- ggdraw() + draw_label("Spawning Potential Ratio (SPR)", size = 22, hjust = 1.72)

Plot_SPR2 <- plot_grid(title, NULL, Plot_SPR1, ncol = 1, rel_heights = c(0.1,-0.035,1))
Plot_SPR2

ggsave("Plot_SPR.png", plot = Plot_SPR2,
       scale = 1, width = 16, height = 14, units = "in")


```




## FFmsy 
```{r, fig.width= 16, fig.height=12}
LH_FFmsy <- readRDS("files/LH_FFmsy.rds")

Plot.LH_FFmsy <- ggplot(LH_FFmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm")) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))

# ggsave("Plot_FFmsyTRUE_LH.png", plot = Plot_FFmsyTrue_LH,
#        scale = 1, width = 14, height = 7, units = "in")



Exp_FFmsy <- readRDS("files/Exp_FFmsy.rds")

Plot.Exp_FFmsy <- ggplot(Exp_FFmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))
 
# ggsave("Plot_FFmsyTRUE_Exp.png", plot = Plot_FFmsyTrue_Exp,
#        scale = 1, width = 14, height = 7, units = "in")



Rec_FFmsy <- readRDS("files/Rec_FFmsy.rds")

Plot.Rec_FFmsy <- ggplot(Rec_FFmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))





Plot_FFmsy <- plot_grid(Plot.LH_FFmsy + theme(legend.position = "none"), NULL, Plot.Exp_FFmsy + theme(legend.position = "none"), NULL, Plot.Rec_FFmsy + theme(legend.position = "none"),
          nrow = 5,
          rel_heights = c(1,-0.05,1,-0.05,1),
          align = "v")
legend <- get_legend(Plot.Exp_FFmsy)

Plot_FFmsy1 <- plot_grid(Plot_FFmsy, legend, labels = c("",""),
                       rel_widths = c(3,0.3)) +
  draw_label("Relative error", x = 0, y = 0.35, hjust = -0.6, vjust = 1, angle = 90, size = 20) 
title <- ggdraw() + draw_label(expression(F/F[MSY]), size = 22, hjust = 7.4)

Plot_FFmsy2 <- plot_grid(title, NULL, Plot_FFmsy1, ncol = 1, rel_heights = c(0.1,-0.025,1))
Plot_FFmsy2

ggsave("Plot_FFmsy.png", plot = Plot_FFmsy2,
       scale = 1, width = 16, height = 14, units = "in")
```





## FM 
```{r, fig.width=16, fig.height=12}
LH_FM <- readRDS("files/LH_FM.rds")

Plot.LH_FM <- ggplot(LH_FM, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm")) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))

# ggsave("Plot_FMTRUE_LH.png", plot = Plot_FMTrue_LH,
#        scale = 1, width = 14, height = 7, units = "in")



Exp_FM <- readRDS("files/Exp_FM.rds")

Plot.Exp_FM <- ggplot(Exp_FM, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))
 
# ggsave("Plot_FMTRUE_Exp.png", plot = Plot_FMTrue_Exp,
#        scale = 1, width = 14, height = 7, units = "in")



Rec_FM <- readRDS("files/Rec_FM.rds")

Plot.Rec_FM <- ggplot(Rec_FM, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))





Plot_FM <- plot_grid(Plot.LH_FM + theme(legend.position = "none"), NULL, Plot.Exp_FM + theme(legend.position = "none"), NULL, Plot.Rec_FM + theme(legend.position = "none"),
          nrow = 5,
          rel_heights = c(1,-0.05,1,-0.05,1),
          align = "v")
legend <- get_legend(Plot.Exp_FM)

Plot_FM1 <- plot_grid(Plot_FM, legend, labels = c("",""),
                       rel_widths = c(3,0.3)) +
  draw_label("Relative error", x = 0, y = 0.35, hjust = -0.6, vjust = 1, angle = 90, size = 20) 
title <- ggdraw() + draw_label("Fishing mortality", size = 22, hjust = 3.36)

Plot_FM2 <- plot_grid(title, NULL, Plot_FM1, ncol = 1, rel_heights = c(0.1,-0.035,1))
Plot_FM2

ggsave("Plot_FM.png", plot = Plot_FM2,
       scale = 1, width = 16, height = 14, units = "in")
```








## Fmsy 
```{r, fig.width=16, fig.height=12}
LH_Fmsy <- readRDS("files/LH_Fmsy.rds")

Plot.LH_Fmsy <- ggplot(LH_Fmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm")) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))

# ggsave("Plot_FmsyTRUE_LH.png", plot = Plot_FmsyTrue_LH,
#        scale = 1, width = 14, height = 7, units = "in")



Exp_Fmsy <- readRDS("files/Exp_Fmsy.rds")

Plot.Exp_Fmsy <- ggplot(Exp_Fmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))
 
# ggsave("Plot_FmsyTRUE_Exp.png", plot = Plot_FmsyTrue_Exp,
#        scale = 1, width = 14, height = 7, units = "in")



Rec_Fmsy <- readRDS("files/Rec_Fmsy.rds")

Plot.Rec_Fmsy <- ggplot(Rec_Fmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))





Plot_Fmsy <- plot_grid(Plot.LH_Fmsy + theme(legend.position = "none"), NULL, Plot.Exp_Fmsy + theme(legend.position = "none"), NULL, Plot.Rec_Fmsy + theme(legend.position = "none"),
          nrow = 5,
          rel_heights = c(1,-0.05,1,-0.05,1),
          align = "v")
legend <- get_legend(Plot.Exp_Fmsy)

Plot_Fmsy1 <- plot_grid(Plot_Fmsy, legend, labels = c("",""),
                       rel_widths = c(3,0.3)) +
  draw_label("Relative error", x = 0, y = 0.35, hjust = -0.6, vjust = 1, angle = 90, size = 20) 
title <- ggdraw() + draw_label(expression(F[MSY]), size = 22, hjust = 11.3)

Plot_Fmsy2 <- plot_grid(title, NULL, Plot_Fmsy1, ncol = 1, rel_heights = c(0.1,-0.035,1))
Plot_Fmsy2

ggsave("Plot_Fmsy.png", plot = Plot_Fmsy2,
       scale = 1, width = 16, height = 14, units = "in")
```





## SPRmsy 
```{r, fig.width=16, fig.height=6}
LH_SPRmsy <- readRDS("files/LH_SPRmsy.rds")

Plot.LH_SPRmsy <- ggplot(LH_SPRmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm")) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))

# ggsave("Plot_SPRmsyTRUE_LH.png", plot = Plot_SPRmsyTrue_LH,
#        scale = 1, width = 16, height = 12, units = "in")



Exp_SPRmsy <- readRDS("files/Exp_SPRmsy.rds")

Plot.Exp_SPRmsy <- ggplot(Exp_SPRmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))
 
# ggsave("Plot_SPRmsyTRUE_Exp.png", plot = Plot_SPRmsyTrue_Exp,
#        scale = 1, width = 14, height = 7, units = "in")



Rec_SPRmsy <- readRDS("files/Rec_SPRmsy.rds")

Plot.Rec_SPRmsy <- ggplot(Rec_SPRmsy, aes(x = Method, y = Relative_error, fill = Method)) +
  geom_violin(trim = F) +
  labs(title = "", y = "") +
  stat_summary(fun.y = median, geom = "point", size = 2, color = "black") +
  geom_hline(yintercept = 0, color = 'darkgrey', size = 1) +
  facet_wrap(~ Scenario, ncol = 3, scale = "fixed") +
  theme_classic() +
  theme(strip.text.x = element_text(size = 20, colour = "black"), axis.text.y = element_text(size = 20), axis.text.y.left = element_text(size = 15), axis.title.y.left = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), legend.title = element_text(size = 16), legend.text = element_text(size = 16)) + guides(keywidth = unit(1,"cm"), keyheight = unit(1,"cm"))





Plot_SPRmsy <- plot_grid(Plot.LH_SPRmsy + theme(legend.position = "none"), NULL, Plot.Exp_SPRmsy + theme(legend.position = "none"), NULL, Plot.Rec_SPRmsy + theme(legend.position = "none"),
          nrow = 5,
          rel_heights = c(1,-0.05,1,-0.05,1),
          align = "v")
legend <- get_legend(Plot.Exp_SPRmsy)

Plot_SPRmsy1 <- plot_grid(Plot_SPRmsy, legend, labels = c("",""),
                       rel_widths = c(3,0.3)) +
  draw_label("Relative error", x = 0, y = 0.35, hjust = -0.6, vjust = 1, angle = 90, size = 20) 
title <- ggdraw() + draw_label(expression(SPR[MSY]), size = 22, hjust = 6.9)

Plot_SPRmsy2 <- plot_grid(title, NULL, Plot_SPRmsy1, ncol = 1, rel_heights = c(0.1,-0.025,1))
Plot_SPRmsy2

ggsave("Plot_SPRmsy.png", plot = Plot_SPRmsy2,
       scale = 1, width = 16, height = 14, units = "in")




rm(list = ls())
```






## Tables
## files
```{r}
LH_SPR.err <- readRDS("files/LH_SPR_err.rds")
LH_FFmsy.err <- readRDS("files/LH_FFmsy_err.rds")
LH_Fmsy.err <- readRDS("files/LH_Fmsy_err.rds")
LH_FM.err <- readRDS("files/LH_FM_err.rds")
LH_SPRmsy.err <- readRDS("files/LH_SPRmsy_err.rds")

Exp_SPR.err <- readRDS("files/Exp_SPR_err.rds")
Exp_FFmsy.err <- readRDS("files/Exp_FFmsy_err.rds")
Exp_Fmsy.err <- readRDS("files/Exp_Fmsy_err.rds")
Exp_FM.err <- readRDS("files/Exp_FM_err.rds")
Exp_SPRmsy.err <- readRDS("files/Exp_SPRmsy_err.rds")

Rec_SPR.err <- readRDS("files/Rec_SPR_err.rds")
Rec_FFmsy.err <- readRDS("files/Rec_FFmsy_err.rds")
Rec_Fmsy.err <- readRDS("files/Rec_Fmsy_err.rds")
Rec_FM.err <- readRDS("files/Rec_FM_err.rds")
Rec_SPRmsy.err <- readRDS("files/Rec_SPRmsy_err.rds")

```

### SPR
```{r}
tab <- matrix(nrow = 8, ncol = 9)
colnames(tab) <- c("Short", "Medium", "Longer", "Target", "Underexploited", "Overexploited", "No Error", "Stochastic", "Autocorrelation")
rownames(tab) <- c("TB MRE", "LBSPR MRE", "LIME MRE", "LBRA MRE", "TB MARE", "LBSPR MARE", "LIME MARE", "LBRA MARE")
tab["TB MRE","Medium"] <- LH_SPR.err$TB["Med","MRE"]
tab["TB MARE","Medium"] <- LH_SPR.err$TB["Med","MARE"]
tab["TB MRE","Short"] <- LH_SPR.err$TB["Short","MRE"]
tab["TB MARE","Short"] <- LH_SPR.err$TB["Short","MARE"]
tab["TB MRE","Longer"] <- LH_SPR.err$TB["Longer","MRE"]
tab["TB MARE","Longer"] <- LH_SPR.err$TB["Longer","MARE"]
tab["TB MRE","Target"] <- Exp_SPR.err$TB["Target","MRE"]
tab["TB MARE","Target"] <- Exp_SPR.err$TB["Target","MARE"]
tab["TB MRE","Underexploited"] <- Exp_SPR.err$TB["Underexploited","MRE"]
tab["TB MARE","Underexploited"] <- Exp_SPR.err$TB["Underexploited","MARE"]
tab["TB MRE","Overexploited"] <- Exp_SPR.err$TB["Overexploited","MRE"]
tab["TB MARE","Overexploited"] <- Exp_SPR.err$TB["Overexploited","MARE"]
tab["TB MRE",7] <- Rec_SPR.err$TB["No error","MRE"]
tab["TB MARE", 7] <- Rec_SPR.err$TB["No error","MARE"]
tab["TB MRE","Stochastic"] <- Rec_SPR.err$TB["Stochastic","MRE"]
tab["TB MARE","Stochastic"] <- Rec_SPR.err$TB["Stochastic","MARE"]
tab["TB MRE","Autocorrelation"] <- Rec_SPR.err$TB["Autocorrelation","MRE"]
tab["TB MARE","Autocorrelation"] <- Rec_SPR.err$TB["Autocorrelation","MARE"]

tab["LBSPR MRE","Medium"] <- LH_SPR.err$LBSPR["Med","MRE"]
tab["LBSPR MARE","Medium"] <- LH_SPR.err$LBSPR["Med","MARE"]
tab["LBSPR MRE","Short"] <- LH_SPR.err$LBSPR["Short","MRE"]
tab["LBSPR MARE","Short"] <- LH_SPR.err$LBSPR["Short","MARE"]
tab["LBSPR MRE","Longer"] <- LH_SPR.err$LBSPR["Longer","MRE"]
tab["LBSPR MARE","Longer"] <- LH_SPR.err$LBSPR["Longer","MARE"]
tab["LBSPR MRE","Target"] <- Exp_SPR.err$LBSPR["Target","MRE"]
tab["LBSPR MARE","Target"] <- Exp_SPR.err$LBSPR["Target","MARE"]
tab["LBSPR MRE","Underexploited"] <- Exp_SPR.err$LBSPR["Underexploited","MRE"]
tab["LBSPR MARE","Underexploited"] <- Exp_SPR.err$LBSPR["Underexploited","MARE"]
tab["LBSPR MRE","Overexploited"] <- Exp_SPR.err$LBSPR["Overexploited","MRE"]
tab["LBSPR MARE","Overexploited"] <- Exp_SPR.err$LBSPR["Overexploited","MARE"]
tab["LBSPR MRE", 7] <- Rec_SPR.err$LBSPR["No error","MRE"]
tab["LBSPR MARE", 7] <- Rec_SPR.err$LBSPR["No error","MARE"]
tab["LBSPR MRE","Stochastic"] <- Rec_SPR.err$LBSPR["Stochastic","MRE"]
tab["LBSPR MARE","Stochastic"] <- Rec_SPR.err$LBSPR["Stochastic","MARE"]
tab["LBSPR MRE","Autocorrelation"] <- Rec_SPR.err$LBSPR["Autocorrelation","MRE"]
tab["LBSPR MARE","Autocorrelation"] <- Rec_SPR.err$LBSPR["Autocorrelation","MARE"]

tab["LIME MRE","Medium"] <- LH_SPR.err$LIME["Med","MRE"]
tab["LIME MARE","Medium"] <- LH_SPR.err$LIME["Med","MARE"]
tab["LIME MRE","Short"] <- LH_SPR.err$LIME["Short","MRE"]
tab["LIME MARE","Short"] <- LH_SPR.err$LIME["Short","MARE"]
tab["LIME MRE","Longer"] <- LH_SPR.err$LIME["Longer","MRE"]
tab["LIME MARE","Longer"] <- LH_SPR.err$LIME["Longer","MARE"]
tab["LIME MRE","Target"] <- Exp_SPR.err$LIME["Target","MRE"]
tab["LIME MARE","Target"] <- Exp_SPR.err$LIME["Target","MARE"]
tab["LIME MRE","Underexploited"] <- Exp_SPR.err$LIME["Underexploited","MRE"]
tab["LIME MARE","Underexploited"] <- Exp_SPR.err$LIME["Underexploited","MARE"]
tab["LIME MRE","Overexploited"] <- Exp_SPR.err$LIME["Overexploited","MRE"]
tab["LIME MARE","Overexploited"] <- Exp_SPR.err$LIME["Overexploited","MARE"]
tab["LIME MRE", 7] <- Rec_SPR.err$LIME["No error","MRE"]
tab["LIME MARE", 7] <- Rec_SPR.err$LIME["No error","MARE"]
tab["LIME MRE","Stochastic"] <- Rec_SPR.err$LIME["Stochastic","MRE"]
tab["LIME MARE","Stochastic"] <- Rec_SPR.err$LIME["Stochastic","MARE"]
tab["LIME MRE","Autocorrelation"] <- Rec_SPR.err$LIME["Autocorrelation","MRE"]
tab["LIME MARE","Autocorrelation"] <- Rec_SPR.err$LIME["Autocorrelation","MARE"]

tab["LBRA MRE","Medium"] <- LH_SPR.err$LBRA["Med","MRE"]
tab["LBRA MARE","Medium"] <- LH_SPR.err$LBRA["Med","MARE"]
tab["LBRA MRE","Short"] <- LH_SPR.err$LBRA["Short","MRE"]
tab["LBRA MARE","Short"] <- LH_SPR.err$LBRA["Short","MARE"]
tab["LBRA MRE","Longer"] <- LH_SPR.err$LBRA["Longer","MRE"]
tab["LBRA MARE","Longer"] <- LH_SPR.err$LBRA["Longer","MARE"]
tab["LBRA MRE","Target"] <- Exp_SPR.err$LBRA["Target","MRE"]
tab["LBRA MARE","Target"] <- Exp_SPR.err$LBRA["Target","MARE"]
tab["LBRA MRE","Underexploited"] <- Exp_SPR.err$LBRA["Underexploited","MRE"]
tab["LBRA MARE","Underexploited"] <- Exp_SPR.err$LBRA["Underexploited","MARE"]
tab["LBRA MRE","Overexploited"] <- Exp_SPR.err$LBRA["Overexploited","MRE"]
tab["LBRA MARE","Overexploited"] <- Exp_SPR.err$LBRA["Overexploited","MARE"]
tab["LBRA MRE", 7] <- Rec_SPR.err$LBRA["No error","MRE"]
tab["LBRA MARE", 7] <- Rec_SPR.err$LBRA["No error","MARE"]
tab["LBRA MRE","Stochastic"] <- Rec_SPR.err$LBRA["Stochastic","MRE"]
tab["LBRA MARE","Stochastic"] <- Rec_SPR.err$LBRA["Stochastic","MARE"]
tab["LBRA MRE","Autocorrelation"] <- Rec_SPR.err$LBRA["Autocorrelation","MRE"]
tab["LBRA MARE","Autocorrelation"] <- Rec_SPR.err$LBRA["Autocorrelation","MARE"]

tab <- round(tab,3)
knitr::kable(tab)
```



### FFmsy
```{r}
tab <- matrix(nrow = 8, ncol = 9)
colnames(tab) <- c("Short", "Medium", "Longer", "Target", "Underexploited", "Overexploited", "No error", "Stochastic", "Autocorrelation")
rownames(tab) <- c("TB MRE", "LBSPR MRE", "LIME MRE", "LBRA MRE", "TB MARE", "LBSPR MARE", "LIME MARE", "LBRA MARE")
tab["TB MRE","Medium"] <- LH_FFmsy.err$TB["Med","MRE"]
tab["TB MARE","Medium"] <- LH_FFmsy.err$TB["Med","MARE"]
tab["TB MRE","Short"] <- LH_FFmsy.err$TB["Short","MRE"]
tab["TB MARE","Short"] <- LH_FFmsy.err$TB["Short","MARE"]
tab["TB MRE","Longer"] <- LH_FFmsy.err$TB["Longer","MRE"]
tab["TB MARE","Longer"] <- LH_FFmsy.err$TB["Longer","MARE"]
tab["TB MRE","Target"] <- Exp_FFmsy.err$TB["Target","MRE"]
tab["TB MARE","Target"] <- Exp_FFmsy.err$TB["Target","MARE"]
tab["TB MRE","Underexploited"] <- Exp_FFmsy.err$TB["Underexploited","MRE"]
tab["TB MARE","Underexploited"] <- Exp_FFmsy.err$TB["Underexploited","MARE"]
tab["TB MRE","Overexploited"] <- Exp_FFmsy.err$TB["Overexploited","MRE"]
tab["TB MARE","Overexploited"] <- Exp_FFmsy.err$TB["Overexploited","MARE"]
tab["TB MRE", 7] <- Rec_FFmsy.err$TB["No error","MRE"]
tab["TB MARE", 7] <- Rec_FFmsy.err$TB["No error","MARE"]
tab["TB MRE","Stochastic"] <- Rec_FFmsy.err$TB["Stochastic","MRE"]
tab["TB MARE","Stochastic"] <- Rec_FFmsy.err$TB["Stochastic","MARE"]
tab["TB MRE","Autocorrelation"] <- Rec_FFmsy.err$TB["Autocorrelation","MRE"]
tab["TB MARE","Autocorrelation"] <- Rec_FFmsy.err$TB["Autocorrelation","MARE"]

tab["LBSPR MRE","Medium"] <- LH_FFmsy.err$LBSPR["Med","MRE"]
tab["LBSPR MARE","Medium"] <- LH_FFmsy.err$LBSPR["Med","MARE"]
tab["LBSPR MRE","Short"] <- LH_FFmsy.err$LBSPR["Short","MRE"]
tab["LBSPR MARE","Short"] <- LH_FFmsy.err$LBSPR["Short","MARE"]
tab["LBSPR MRE","Longer"] <- LH_FFmsy.err$LBSPR["Longer","MRE"]
tab["LBSPR MARE","Longer"] <- LH_FFmsy.err$LBSPR["Longer","MARE"]
tab["LBSPR MRE","Target"] <- Exp_FFmsy.err$LBSPR["Target","MRE"]
tab["LBSPR MARE","Target"] <- Exp_FFmsy.err$LBSPR["Target","MARE"]
tab["LBSPR MRE","Underexploited"] <- Exp_FFmsy.err$LBSPR["Underexploited","MRE"]
tab["LBSPR MARE","Underexploited"] <- Exp_FFmsy.err$LBSPR["Underexploited","MARE"]
tab["LBSPR MRE","Overexploited"] <- Exp_FFmsy.err$LBSPR["Overexploited","MRE"]
tab["LBSPR MARE","Overexploited"] <- Exp_FFmsy.err$LBSPR["Overexploited","MARE"]
tab["LBSPR MRE", 7] <- Rec_FFmsy.err$LBSPR["No error","MRE"]
tab["LBSPR MARE", 7] <- Rec_FFmsy.err$LBSPR["No error","MARE"]
tab["LBSPR MRE","Stochastic"] <- Rec_FFmsy.err$LBSPR["Stochastic","MRE"]
tab["LBSPR MARE","Stochastic"] <- Rec_FFmsy.err$LBSPR["Stochastic","MARE"]
tab["LBSPR MRE","Autocorrelation"] <- Rec_FFmsy.err$LBSPR["Autocorrelation","MRE"]
tab["LBSPR MARE","Autocorrelation"] <- Rec_FFmsy.err$LBSPR["Autocorrelation","MARE"]

tab["LIME MRE","Medium"] <- LH_FFmsy.err$LIME["Med","MRE"]
tab["LIME MARE","Medium"] <- LH_FFmsy.err$LIME["Med","MARE"]
tab["LIME MRE","Short"] <- LH_FFmsy.err$LIME["Short","MRE"]
tab["LIME MARE","Short"] <- LH_FFmsy.err$LIME["Short","MARE"]
tab["LIME MRE","Longer"] <- LH_FFmsy.err$LIME["Longer","MRE"]
tab["LIME MARE","Longer"] <- LH_FFmsy.err$LIME["Longer","MARE"]
tab["LIME MRE","Target"] <- Exp_FFmsy.err$LIME["Target","MRE"]
tab["LIME MARE","Target"] <- Exp_FFmsy.err$LIME["Target","MARE"]
tab["LIME MRE","Underexploited"] <- Exp_FFmsy.err$LIME["Underexploited","MRE"]
tab["LIME MARE","Underexploited"] <- Exp_FFmsy.err$LIME["Underexploited","MARE"]
tab["LIME MRE","Overexploited"] <- Exp_FFmsy.err$LIME["Overexploited","MRE"]
tab["LIME MARE","Overexploited"] <- Exp_FFmsy.err$LIME["Overexploited","MARE"]
tab["LIME MRE", 7] <- Rec_FFmsy.err$LIME["No error","MRE"]
tab["LIME MARE", 7] <- Rec_FFmsy.err$LIME["No error","MARE"]
tab["LIME MRE","Stochastic"] <- Rec_FFmsy.err$LIME["Stochastic","MRE"]
tab["LIME MARE","Stochastic"] <- Rec_FFmsy.err$LIME["Stochastic","MARE"]
tab["LIME MRE","Autocorrelation"] <- Rec_FFmsy.err$LIME["Autocorrelation","MRE"]
tab["LIME MARE","Autocorrelation"] <- Rec_FFmsy.err$LIME["Autocorrelation","MARE"]

tab["LBRA MRE","Medium"] <- LH_FFmsy.err$LBRA["Med","MRE"]
tab["LBRA MARE","Medium"] <- LH_FFmsy.err$LBRA["Med","MARE"]
tab["LBRA MRE","Short"] <- LH_FFmsy.err$LBRA["Short","MRE"]
tab["LBRA MARE","Short"] <- LH_FFmsy.err$LBRA["Short","MARE"]
tab["LBRA MRE","Longer"] <- LH_FFmsy.err$LBRA["Longer","MRE"]
tab["LBRA MARE","Longer"] <- LH_FFmsy.err$LBRA["Longer","MARE"]
tab["LBRA MRE","Target"] <- Exp_FFmsy.err$LBRA["Target","MRE"]
tab["LBRA MARE","Target"] <- Exp_FFmsy.err$LBRA["Target","MARE"]
tab["LBRA MRE","Underexploited"] <- Exp_FFmsy.err$LBRA["Underexploited","MRE"]
tab["LBRA MARE","Underexploited"] <- Exp_FFmsy.err$LBRA["Underexploited","MARE"]
tab["LBRA MRE","Overexploited"] <- Exp_FFmsy.err$LBRA["Overexploited","MRE"]
tab["LBRA MARE","Overexploited"] <- Exp_FFmsy.err$LBRA["Overexploited","MARE"]
tab["LBRA MRE", 7] <- Rec_FFmsy.err$LBRA["No error","MRE"]
tab["LBRA MARE", 7] <- Rec_FFmsy.err$LBRA["No error","MARE"]
tab["LBRA MRE","Stochastic"] <- Rec_FFmsy.err$LBRA["Stochastic","MRE"]
tab["LBRA MARE","Stochastic"] <- Rec_FFmsy.err$LBRA["Stochastic","MARE"]
tab["LBRA MRE","Autocorrelation"] <- Rec_FFmsy.err$LBRA["Autocorrelation","MRE"]
tab["LBRA MARE","Autocorrelation"] <- Rec_FFmsy.err$LBRA["Autocorrelation","MARE"]

tab <- round(tab,3)
knitr::kable(tab)


```

### FM
```{r}
tab <- matrix(nrow = 8, ncol = 9)
colnames(tab) <- c("Short", "Medium", "Longer", "Target", "Underexploited", "Overexploited", "No error", "Stochastic", "Autocorrelation")
rownames(tab) <- c("TB MRE", "LBSPR MRE", "LIME MRE", "LBRA MRE", "TB MARE", "LBSPR MARE", "LIME MARE", "LBRA MARE")
tab["TB MRE","Medium"] <- LH_FM.err$TB["Med","MRE"]
tab["TB MARE","Medium"] <- LH_FM.err$TB["Med","MARE"]
tab["TB MRE","Short"] <- LH_FM.err$TB["Short","MRE"]
tab["TB MARE","Short"] <- LH_FM.err$TB["Short","MARE"]
tab["TB MRE","Longer"] <- LH_FM.err$TB["Longer","MRE"]
tab["TB MARE","Longer"] <- LH_FM.err$TB["Longer","MARE"]
tab["TB MRE","Target"] <- Exp_FM.err$TB["Target","MRE"]
tab["TB MARE","Target"] <- Exp_FM.err$TB["Target","MARE"]
tab["TB MRE","Underexploited"] <- Exp_FM.err$TB["Underexploited","MRE"]
tab["TB MARE","Underexploited"] <- Exp_FM.err$TB["Underexploited","MARE"]
tab["TB MRE","Overexploited"] <- Exp_FM.err$TB["Overexploited","MRE"]
tab["TB MARE","Overexploited"] <- Exp_FM.err$TB["Overexploited","MARE"]
tab["TB MRE", 7] <- Rec_FM.err$TB["No error","MRE"]
tab["TB MARE", 7] <- Rec_FM.err$TB["No error","MARE"]
tab["TB MRE","Stochastic"] <- Rec_FM.err$TB["Stochastic","MRE"]
tab["TB MARE","Stochastic"] <- Rec_FM.err$TB["Stochastic","MARE"]
tab["TB MRE","Autocorrelation"] <- Rec_FM.err$TB["Autocorrelation","MRE"]
tab["TB MARE","Autocorrelation"] <- Rec_FM.err$TB["Autocorrelation","MARE"]

tab["LBSPR MRE","Medium"] <- LH_FM.err$LBSPR["Med","MRE"]
tab["LBSPR MARE","Medium"] <- LH_FM.err$LBSPR["Med","MARE"]
tab["LBSPR MRE","Short"] <- LH_FM.err$LBSPR["Short","MRE"]
tab["LBSPR MARE","Short"] <- LH_FM.err$LBSPR["Short","MARE"]
tab["LBSPR MRE","Longer"] <- LH_FM.err$LBSPR["Longer","MRE"]
tab["LBSPR MARE","Longer"] <- LH_FM.err$LBSPR["Longer","MARE"]
tab["LBSPR MRE","Target"] <- Exp_FM.err$LBSPR["Target","MRE"]
tab["LBSPR MARE","Target"] <- Exp_FM.err$LBSPR["Target","MARE"]
tab["LBSPR MRE","Underexploited"] <- Exp_FM.err$LBSPR["Underexploited","MRE"]
tab["LBSPR MARE","Underexploited"] <- Exp_FM.err$LBSPR["Underexploited","MARE"]
tab["LBSPR MRE","Overexploited"] <- Exp_FM.err$LBSPR["Overexploited","MRE"]
tab["LBSPR MARE","Overexploited"] <- Exp_FM.err$LBSPR["Overexploited","MARE"]
tab["LBSPR MRE", 7] <- Rec_FM.err$LBSPR["No error","MRE"]
tab["LBSPR MARE", 7] <- Rec_FM.err$LBSPR["No error","MARE"]
tab["LBSPR MRE","Stochastic"] <- Rec_FM.err$LBSPR["Stochastic","MRE"]
tab["LBSPR MARE","Stochastic"] <- Rec_FM.err$LBSPR["Stochastic","MARE"]
tab["LBSPR MRE","Autocorrelation"] <- Rec_FM.err$LBSPR["Autocorrelation","MRE"]
tab["LBSPR MARE","Autocorrelation"] <- Rec_FM.err$LBSPR["Autocorrelation","MARE"]

tab["LIME MRE","Medium"] <- LH_FM.err$LIME["Med","MRE"]
tab["LIME MARE","Medium"] <- LH_FM.err$LIME["Med","MARE"]
tab["LIME MRE","Short"] <- LH_FM.err$LIME["Short","MRE"]
tab["LIME MARE","Short"] <- LH_FM.err$LIME["Short","MARE"]
tab["LIME MRE","Longer"] <- LH_FM.err$LIME["Longer","MRE"]
tab["LIME MARE","Longer"] <- LH_FM.err$LIME["Longer","MARE"]
tab["LIME MRE","Target"] <- Exp_FM.err$LIME["Target","MRE"]
tab["LIME MARE","Target"] <- Exp_FM.err$LIME["Target","MARE"]
tab["LIME MRE","Underexploited"] <- Exp_FM.err$LIME["Underexploited","MRE"]
tab["LIME MARE","Underexploited"] <- Exp_FM.err$LIME["Underexploited","MARE"]
tab["LIME MRE","Overexploited"] <- Exp_FM.err$LIME["Overexploited","MRE"]
tab["LIME MARE","Overexploited"] <- Exp_FM.err$LIME["Overexploited","MARE"]
tab["LIME MRE", 7] <- Rec_FM.err$LIME["No error","MRE"]
tab["LIME MARE", 7] <- Rec_FM.err$LIME["No error","MARE"]
tab["LIME MRE","Stochastic"] <- Rec_FM.err$LIME["Stochastic","MRE"]
tab["LIME MARE","Stochastic"] <- Rec_FM.err$LIME["Stochastic","MARE"]
tab["LIME MRE","Autocorrelation"] <- Rec_FM.err$LIME["Autocorrelation","MRE"]
tab["LIME MARE","Autocorrelation"] <- Rec_FM.err$LIME["Autocorrelation","MARE"]

tab["LBRA MRE","Medium"] <- LH_FM.err$LBRA["Med","MRE"]
tab["LBRA MARE","Medium"] <- LH_FM.err$LBRA["Med","MARE"]
tab["LBRA MRE","Short"] <- LH_FM.err$LBRA["Short","MRE"]
tab["LBRA MARE","Short"] <- LH_FM.err$LBRA["Short","MARE"]
tab["LBRA MRE","Longer"] <- LH_FM.err$LBRA["Longer","MRE"]
tab["LBRA MARE","Longer"] <- LH_FM.err$LBRA["Longer","MARE"]
tab["LBRA MRE","Target"] <- Exp_FM.err$LBRA["Target","MRE"]
tab["LBRA MARE","Target"] <- Exp_FM.err$LBRA["Target","MARE"]
tab["LBRA MRE","Underexploited"] <- Exp_FM.err$LBRA["Underexploited","MRE"]
tab["LBRA MARE","Underexploited"] <- Exp_FM.err$LBRA["Underexploited","MARE"]
tab["LBRA MRE","Overexploited"] <- Exp_FM.err$LBRA["Overexploited","MRE"]
tab["LBRA MARE","Overexploited"] <- Exp_FM.err$LBRA["Overexploited","MARE"]
tab["LBRA MRE", 7] <- Rec_FM.err$LBRA["No error","MRE"]
tab["LBRA MARE", 7] <- Rec_FM.err$LBRA["No error","MARE"]
tab["LBRA MRE","Stochastic"] <- Rec_FM.err$LBRA["Stochastic","MRE"]
tab["LBRA MARE","Stochastic"] <- Rec_FM.err$LBRA["Stochastic","MARE"]
tab["LBRA MRE","Autocorrelation"] <- Rec_FM.err$LBRA["Autocorrelation","MRE"]
tab["LBRA MARE","Autocorrelation"] <- Rec_FM.err$LBRA["Autocorrelation","MARE"]

tab <- round(tab,3)
knitr::kable(tab)


```


### Fmsy
```{r}
tab <- matrix(nrow = 8, ncol = 9)
colnames(tab) <- c("Short", "Medium", "Longer", "Target", "Underexploited", "Overexploited", "No error", "Stochastic", "Autocorrelation")
rownames(tab) <- c("TB MRE", "LBSPR MRE", "LIME MRE", "LBRA MRE", "TB MARE", "LBSPR MARE", "LIME MARE", "LBRA MARE")
tab["TB MRE","Medium"] <- LH_Fmsy.err$TB["Med","MRE"]
tab["TB MARE","Medium"] <- LH_Fmsy.err$TB["Med","MARE"]
tab["TB MRE","Short"] <- LH_Fmsy.err$TB["Short","MRE"]
tab["TB MARE","Short"] <- LH_Fmsy.err$TB["Short","MARE"]
tab["TB MRE","Longer"] <- LH_Fmsy.err$TB["Longer","MRE"]
tab["TB MARE","Longer"] <- LH_Fmsy.err$TB["Longer","MARE"]
tab["TB MRE","Target"] <- Exp_Fmsy.err$TB["Target","MRE"]
tab["TB MARE","Target"] <- Exp_Fmsy.err$TB["Target","MARE"]
tab["TB MRE","Underexploited"] <- Exp_Fmsy.err$TB["Underexploited","MRE"]
tab["TB MARE","Underexploited"] <- Exp_Fmsy.err$TB["Underexploited","MARE"]
tab["TB MRE","Overexploited"] <- Exp_Fmsy.err$TB["Overexploited","MRE"]
tab["TB MARE","Overexploited"] <- Exp_Fmsy.err$TB["Overexploited","MARE"]
tab["TB MRE", 7] <- Rec_Fmsy.err$TB["No error","MRE"]
tab["TB MARE", 7] <- Rec_Fmsy.err$TB["No error","MARE"]
tab["TB MRE","Stochastic"] <- Rec_Fmsy.err$TB["Stochastic","MRE"]
tab["TB MARE","Stochastic"] <- Rec_Fmsy.err$TB["Stochastic","MARE"]
tab["TB MRE","Autocorrelation"] <- Rec_Fmsy.err$TB["Autocorrelation","MRE"]
tab["TB MARE","Autocorrelation"] <- Rec_Fmsy.err$TB["Autocorrelation","MARE"]

tab["LBSPR MRE","Medium"] <- LH_Fmsy.err$LBSPR["Med","MRE"]
tab["LBSPR MARE","Medium"] <- LH_Fmsy.err$LBSPR["Med","MARE"]
tab["LBSPR MRE","Short"] <- LH_Fmsy.err$LBSPR["Short","MRE"]
tab["LBSPR MARE","Short"] <- LH_Fmsy.err$LBSPR["Short","MARE"]
tab["LBSPR MRE","Longer"] <- LH_Fmsy.err$LBSPR["Longer","MRE"]
tab["LBSPR MARE","Longer"] <- LH_Fmsy.err$LBSPR["Longer","MARE"]
tab["LBSPR MRE","Target"] <- Exp_Fmsy.err$LBSPR["Target","MRE"]
tab["LBSPR MARE","Target"] <- Exp_Fmsy.err$LBSPR["Target","MARE"]
tab["LBSPR MRE","Underexploited"] <- Exp_Fmsy.err$LBSPR["Underexploited","MRE"]
tab["LBSPR MARE","Underexploited"] <- Exp_Fmsy.err$LBSPR["Underexploited","MARE"]
tab["LBSPR MRE","Overexploited"] <- Exp_Fmsy.err$LBSPR["Overexploited","MRE"]
tab["LBSPR MARE","Overexploited"] <- Exp_Fmsy.err$LBSPR["Overexploited","MARE"]
tab["LBSPR MRE", 7] <- Rec_Fmsy.err$LBSPR["No error","MRE"]
tab["LBSPR MARE", 7] <- Rec_Fmsy.err$LBSPR["No error","MARE"]
tab["LBSPR MRE","Stochastic"] <- Rec_Fmsy.err$LBSPR["Stochastic","MRE"]
tab["LBSPR MARE","Stochastic"] <- Rec_Fmsy.err$LBSPR["Stochastic","MARE"]
tab["LBSPR MRE","Autocorrelation"] <- Rec_Fmsy.err$LBSPR["Autocorrelation","MRE"]
tab["LBSPR MARE","Autocorrelation"] <- Rec_Fmsy.err$LBSPR["Autocorrelation","MARE"]

tab["LIME MRE","Medium"] <- LH_Fmsy.err$LIME["Med","MRE"]
tab["LIME MARE","Medium"] <- LH_Fmsy.err$LIME["Med","MARE"]
tab["LIME MRE","Short"] <- LH_Fmsy.err$LIME["Short","MRE"]
tab["LIME MARE","Short"] <- LH_Fmsy.err$LIME["Short","MARE"]
tab["LIME MRE","Longer"] <- LH_Fmsy.err$LIME["Longer","MRE"]
tab["LIME MARE","Longer"] <- LH_Fmsy.err$LIME["Longer","MARE"]
tab["LIME MRE","Target"] <- Exp_Fmsy.err$LIME["Target","MRE"]
tab["LIME MARE","Target"] <- Exp_Fmsy.err$LIME["Target","MARE"]
tab["LIME MRE","Underexploited"] <- Exp_Fmsy.err$LIME["Underexploited","MRE"]
tab["LIME MARE","Underexploited"] <- Exp_Fmsy.err$LIME["Underexploited","MARE"]
tab["LIME MRE","Overexploited"] <- Exp_Fmsy.err$LIME["Overexploited","MRE"]
tab["LIME MARE","Overexploited"] <- Exp_Fmsy.err$LIME["Overexploited","MARE"]
tab["LIME MRE", 7] <- Rec_Fmsy.err$LIME["No error","MRE"]
tab["LIME MARE", 7] <- Rec_Fmsy.err$LIME["No error","MARE"]
tab["LIME MRE","Stochastic"] <- Rec_Fmsy.err$LIME["Stochastic","MRE"]
tab["LIME MARE","Stochastic"] <- Rec_Fmsy.err$LIME["Stochastic","MARE"]
tab["LIME MRE","Autocorrelation"] <- Rec_Fmsy.err$LIME["Autocorrelation","MRE"]
tab["LIME MARE","Autocorrelation"] <- Rec_Fmsy.err$LIME["Autocorrelation","MARE"]

tab["LBRA MRE","Medium"] <- LH_Fmsy.err$LBRA["Med","MRE"]
tab["LBRA MARE","Medium"] <- LH_Fmsy.err$LBRA["Med","MARE"]
tab["LBRA MRE","Short"] <- LH_Fmsy.err$LBRA["Short","MRE"]
tab["LBRA MARE","Short"] <- LH_Fmsy.err$LBRA["Short","MARE"]
tab["LBRA MRE","Longer"] <- LH_Fmsy.err$LBRA["Longer","MRE"]
tab["LBRA MARE","Longer"] <- LH_Fmsy.err$LBRA["Longer","MARE"]
tab["LBRA MRE","Target"] <- Exp_Fmsy.err$LBRA["Target","MRE"]
tab["LBRA MARE","Target"] <- Exp_Fmsy.err$LBRA["Target","MARE"]
tab["LBRA MRE","Underexploited"] <- Exp_Fmsy.err$LBRA["Underexploited","MRE"]
tab["LBRA MARE","Underexploited"] <- Exp_Fmsy.err$LBRA["Underexploited","MARE"]
tab["LBRA MRE","Overexploited"] <- Exp_Fmsy.err$LBRA["Overexploited","MRE"]
tab["LBRA MARE","Overexploited"] <- Exp_Fmsy.err$LBRA["Overexploited","MARE"]
tab["LBRA MRE", 7] <- Rec_Fmsy.err$LBRA["No error","MRE"]
tab["LBRA MARE", 7] <- Rec_Fmsy.err$LBRA["No error","MARE"]
tab["LBRA MRE","Stochastic"] <- Rec_Fmsy.err$LBRA["Stochastic","MRE"]
tab["LBRA MARE","Stochastic"] <- Rec_Fmsy.err$LBRA["Stochastic","MARE"]
tab["LBRA MRE","Autocorrelation"] <- Rec_Fmsy.err$LBRA["Autocorrelation","MRE"]
tab["LBRA MARE","Autocorrelation"] <- Rec_Fmsy.err$LBRA["Autocorrelation","MARE"]

tab <- round(tab,3)
knitr::kable(tab)


```




### SPRmsy
```{r}
tab <- matrix(nrow = 8, ncol = 9)
colnames(tab) <- c("Short", "Medium", "Longer", "Target", "Underexploited", "Overexploited", "No error", "Stochastic", "Autocorrelation")
rownames(tab) <- c("TB MRE", "LBSPR MRE", "LIME MRE", "LBRA MRE", "TB MARE", "LBSPR MARE", "LIME MARE", "LBRA MARE")
tab["TB MRE","Medium"] <- LH_SPRmsy.err$TB["Med","MRE"]
tab["TB MARE","Medium"] <- LH_SPRmsy.err$TB["Med","MARE"]
tab["TB MRE","Short"] <- LH_SPRmsy.err$TB["Short","MRE"]
tab["TB MARE","Short"] <- LH_SPRmsy.err$TB["Short","MARE"]
tab["TB MRE","Longer"] <- LH_SPRmsy.err$TB["Longer","MRE"]
tab["TB MARE","Longer"] <- LH_SPRmsy.err$TB["Longer","MARE"]
tab["TB MRE","Target"] <- Exp_SPRmsy.err$TB["Target","MRE"]
tab["TB MARE","Target"] <- Exp_SPRmsy.err$TB["Target","MARE"]
tab["TB MRE","Underexploited"] <- Exp_SPRmsy.err$TB["Underexploited","MRE"]
tab["TB MARE","Underexploited"] <- Exp_SPRmsy.err$TB["Underexploited","MARE"]
tab["TB MRE","Overexploited"] <- Exp_SPRmsy.err$TB["Overexploited","MRE"]
tab["TB MARE","Overexploited"] <- Exp_SPRmsy.err$TB["Overexploited","MARE"]
tab["TB MRE", 7] <- Rec_SPRmsy.err$TB["No error","MRE"]
tab["TB MARE", 7] <- Rec_SPRmsy.err$TB["No error","MARE"]
tab["TB MRE","Stochastic"] <- Rec_SPRmsy.err$TB["Stochastic","MRE"]
tab["TB MARE","Stochastic"] <- Rec_SPRmsy.err$TB["Stochastic","MARE"]
tab["TB MRE","Autocorrelation"] <- Rec_SPRmsy.err$TB["Autocorrelation","MRE"]
tab["TB MARE","Autocorrelation"] <- Rec_SPRmsy.err$TB["Autocorrelation","MARE"]

tab["LBSPR MRE","Medium"] <- LH_SPRmsy.err$LBSPR["Med","MRE"]
tab["LBSPR MARE","Medium"] <- LH_SPRmsy.err$LBSPR["Med","MARE"]
tab["LBSPR MRE","Short"] <- LH_SPRmsy.err$LBSPR["Short","MRE"]
tab["LBSPR MARE","Short"] <- LH_SPRmsy.err$LBSPR["Short","MARE"]
tab["LBSPR MRE","Longer"] <- LH_SPRmsy.err$LBSPR["Longer","MRE"]
tab["LBSPR MARE","Longer"] <- LH_SPRmsy.err$LBSPR["Longer","MARE"]
tab["LBSPR MRE","Target"] <- Exp_SPRmsy.err$LBSPR["Target","MRE"]
tab["LBSPR MARE","Target"] <- Exp_SPRmsy.err$LBSPR["Target","MARE"]
tab["LBSPR MRE","Underexploited"] <- Exp_SPRmsy.err$LBSPR["Underexploited","MRE"]
tab["LBSPR MARE","Underexploited"] <- Exp_SPRmsy.err$LBSPR["Underexploited","MARE"]
tab["LBSPR MRE","Overexploited"] <- Exp_SPRmsy.err$LBSPR["Overexploited","MRE"]
tab["LBSPR MARE","Overexploited"] <- Exp_SPRmsy.err$LBSPR["Overexploited","MARE"]
tab["LBSPR MRE", 7] <- Rec_SPRmsy.err$LBSPR["No error","MRE"]
tab["LBSPR MARE", 7] <- Rec_SPRmsy.err$LBSPR["No error","MARE"]
tab["LBSPR MRE","Stochastic"] <- Rec_SPRmsy.err$LBSPR["Stochastic","MRE"]
tab["LBSPR MARE","Stochastic"] <- Rec_SPRmsy.err$LBSPR["Stochastic","MARE"]
tab["LBSPR MRE","Autocorrelation"] <- Rec_SPRmsy.err$LBSPR["Autocorrelation","MRE"]
tab["LBSPR MARE","Autocorrelation"] <- Rec_SPRmsy.err$LBSPR["Autocorrelation","MARE"]

tab["LIME MRE","Medium"] <- LH_SPRmsy.err$LIME["Med","MRE"]
tab["LIME MARE","Medium"] <- LH_SPRmsy.err$LIME["Med","MARE"]
tab["LIME MRE","Short"] <- LH_SPRmsy.err$LIME["Short","MRE"]
tab["LIME MARE","Short"] <- LH_SPRmsy.err$LIME["Short","MARE"]
tab["LIME MRE","Longer"] <- LH_SPRmsy.err$LIME["Longer","MRE"]
tab["LIME MARE","Longer"] <- LH_SPRmsy.err$LIME["Longer","MARE"]
tab["LIME MRE","Target"] <- Exp_SPRmsy.err$LIME["Target","MRE"]
tab["LIME MARE","Target"] <- Exp_SPRmsy.err$LIME["Target","MARE"]
tab["LIME MRE","Underexploited"] <- Exp_SPRmsy.err$LIME["Underexploited","MRE"]
tab["LIME MARE","Underexploited"] <- Exp_SPRmsy.err$LIME["Underexploited","MARE"]
tab["LIME MRE","Overexploited"] <- Exp_SPRmsy.err$LIME["Overexploited","MRE"]
tab["LIME MARE","Overexploited"] <- Exp_SPRmsy.err$LIME["Overexploited","MARE"]
tab["LIME MRE", 7] <- Rec_SPRmsy.err$LIME["No error","MRE"]
tab["LIME MARE", 7] <- Rec_SPRmsy.err$LIME["No error","MARE"]
tab["LIME MRE","Stochastic"] <- Rec_SPRmsy.err$LIME["Stochastic","MRE"]
tab["LIME MARE","Stochastic"] <- Rec_SPRmsy.err$LIME["Stochastic","MARE"]
tab["LIME MRE","Autocorrelation"] <- Rec_SPRmsy.err$LIME["Autocorrelation","MRE"]
tab["LIME MARE","Autocorrelation"] <- Rec_SPRmsy.err$LIME["Autocorrelation","MARE"]

tab["LBRA MRE","Medium"] <- LH_SPRmsy.err$LBRA["Med","MRE"]
tab["LBRA MARE","Medium"] <- LH_SPRmsy.err$LBRA["Med","MARE"]
tab["LBRA MRE","Short"] <- LH_SPRmsy.err$LBRA["Short","MRE"]
tab["LBRA MARE","Short"] <- LH_SPRmsy.err$LBRA["Short","MARE"]
tab["LBRA MRE","Longer"] <- LH_SPRmsy.err$LBRA["Longer","MRE"]
tab["LBRA MARE","Longer"] <- LH_SPRmsy.err$LBRA["Longer","MARE"]
tab["LBRA MRE","Target"] <- Exp_SPRmsy.err$LBRA["Target","MRE"]
tab["LBRA MARE","Target"] <- Exp_SPRmsy.err$LBRA["Target","MARE"]
tab["LBRA MRE","Underexploited"] <- Exp_SPRmsy.err$LBRA["Underexploited","MRE"]
tab["LBRA MARE","Underexploited"] <- Exp_SPRmsy.err$LBRA["Underexploited","MARE"]
tab["LBRA MRE","Overexploited"] <- Exp_SPRmsy.err$LBRA["Overexploited","MRE"]
tab["LBRA MARE","Overexploited"] <- Exp_SPRmsy.err$LBRA["Overexploited","MARE"]
tab["LBRA MRE", 7] <- Rec_SPRmsy.err$LBRA["No error","MRE"]
tab["LBRA MARE", 7] <- Rec_SPRmsy.err$LBRA["No error","MARE"]
tab["LBRA MRE","Stochastic"] <- Rec_SPRmsy.err$LBRA["Stochastic","MRE"]
tab["LBRA MARE","Stochastic"] <- Rec_SPRmsy.err$LBRA["Stochastic","MARE"]
tab["LBRA MRE","Autocorrelation"] <- Rec_SPRmsy.err$LBRA["Autocorrelation","MRE"]
tab["LBRA MARE","Autocorrelation"] <- Rec_SPRmsy.err$LBRA["Autocorrelation","MARE"]

tab <- round(tab,3)
knitr::kable(tab)


```

